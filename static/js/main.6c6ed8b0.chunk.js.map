{"version":3,"sources":["Test/Test.js","PixiViz/PixiViz.js","Utilities/Utilities.js","App.js","serviceWorker.js","index.js"],"names":["projection","pixiApp","viewport","container","Utilities","size","minScale","maxScale","width","height","simulation","d3","stop","emoji","clampZoomOptions","Test","props","state","data","componentNode","this","_rootNode","then","csv","byDates","key","d","entries","raw_data","length","values","fitSize","map","translate","scale","center","forEach","r","point","long","lat","x","y","i","categories","c","ii","obj","denominazione_regione","find","dd","push","setState","svg","g","append","call","extent","window","innerWidth","innerHeight","scaleExtent","on","attr","transform","nodes","selectAll","enter","text","emoji_dictionary","category","alphaDecay","prompt","force","_x","_y","strength","alpha","console","log","simulationIsRunning","index","vx","vy","blob","Blob","JSON","stringify","type","FileSaver","saveAs","restart","spatialization","document","title","requestAnimationFrame","addEventListener","event","a","ref","_setRef","bind","style","Component","dpr","devicePixelRatio","PixiViz","loadData","textures","Promise","all","icons","querySelectorAll","html2canvas","backgroundColor","canvas","id","toDataURL","Object","keys","files","mapData","PIXI","resolution","autoResize","appendChild","view","Viewport","passiveWheel","stopPropagation","divWheel","screenWidth","screenHeight","worldWidth","worldHeight","interaction","renderer","plugins","clampZoom","drag","pressDrag","clampWheel","pinch","wheel","stage","addChild","features","region","this_graphics","path","context","beginFill","lineStyle","endFill","sprite","from","anchor","set","fontSize","position","top","App","className","basename","exact","to","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.6c6ed8b0.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport FileSaver from 'file-saver';\n\nimport Utilities from '../Utilities/Utilities';\n\nconst data_url = 'https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv';\nconst simulation = d3.forceSimulation().stop();\n\nconst size = Utilities.emoji.size/Utilities.clampZoomOptions.maxScale;\n\nlet projection;\n\nclass Test extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      data: []\n    }\n  }\n  _setRef(componentNode) {\n    this._rootNode = componentNode;\n  }\n  componentDidMount() {\n    d3.csv(data_url).then(csv=>{\n\n      // csv = csv.filter(d=>d.denominazione_regione==='Sicilia'||d.denominazione_regione===\"Valle d'Aosta\"||d.denominazione_regione===\"Lazio\")\n      // csv = csv.filter(d=>d.denominazione_regione==='Lombardia')\n      // csv = csv.filter(d=>d.denominazione_regione==='Lazio')\n\n      const byDates = d3.nest()\n        .key(d=>d.data)\n        .entries(csv);\n      \n      const raw_data = byDates[byDates.length-1].values;\n      const data = [];\n\n      projection = d3.geoConicEqualArea()\n        .fitSize([Utilities.map.width-50, Utilities.map.height-50], this._rootNode)\n        .translate([Utilities.map.width / 2, Utilities.map.height / 2])\n        .scale(3000)\n        .center([12.368775000000001, 42.9451139]);\n\n      raw_data.forEach(r=>{\n        const point = projection([r.long,r.lat]);\n        r.x = point[0];\n        r.y = point[1];\n      })\n\n      for(let i=0; i<raw_data.length; ++i) {\n        Utilities.categories.forEach(c=>{\n          for (let ii=0; ii<raw_data[i][c]; ++ii){\n            const obj={\n              'category': c,\n              'denominazione_regione': raw_data[i].denominazione_regione,\n              'date': raw_data[i].data,\n              '_x': raw_data.find(dd=>dd.denominazione_regione===raw_data[i].denominazione_regione).x,\n              '_y': raw_data.find(dd=>dd.denominazione_regione===raw_data[i].denominazione_regione).y,\n              'x': raw_data.find(dd=>dd.denominazione_regione===raw_data[i].denominazione_regione).x + d3.randomUniform(-50,50)(),\n              'y': raw_data.find(dd=>dd.denominazione_regione===raw_data[i].denominazione_regione).y + d3.randomUniform(-50,50)()\n            }\n            data.push(obj);\n          }\n        })\n      }\n      this.setState({raw_data:raw_data, data:data}, ()=>{\n\n        const svg = d3.select(this._rootNode);\n        const g = svg.append('g');\n          \n        svg.call(d3.zoom()\n          .extent([[0, 0], [window.innerWidth, window.innerHeight]])\n          .scaleExtent([Utilities.clampZoomOptions.minScale, Utilities.clampZoomOptions.maxScale])\n          .on(\"zoom\", zoomed));\n\n        function zoomed() {\n          g.attr(\"transform\", d3.event.transform);\n        }\n\n        let nodes = g.selectAll('text').data(this.state.data).enter().append('text')\n          .attr('font-size',size+'px')\n          .text(d=>Utilities.emoji_dictionary[d.category]);\n\n        const alphaDecay = window.prompt('Set the alpha decay of force simulation, once finished it will generate a JSON with the spatialized positions', 0.05);\n\n        simulation.nodes(data)\n          // .on(\"tick\", ()=>{\n          //   nodes\n          //     .attr('x',d=>d.x)\n          //     .attr('y',d=>d.y);\n          //   document.title = simulation.alpha();\n          // })\n          .force(\"x\", d3.forceX(d=>d._x))\n          .force(\"y\", d3.forceY(d=>d._y))\n          .force(\"charge\", d3.forceManyBody().strength(-0.09))\n          .alphaDecay(alphaDecay)\n          .alpha(1)\n          .on(\"end\", () => {\n            console.log('ended',data, simulation);\n            simulationIsRunning = false;\n\n            nodes\n              .attr('x',d=>d.x)\n              .attr('y',d=>d.y);\n\n            for (let i=0; i<data.length; ++i){\n              console.log(i);\n              data[i]._x = data[i].x;\n              data[i]._y = data[i].y;\n              delete data[i].index;\n              delete data[i].vx;\n              delete data[i].vy;\n              delete data[i].x;\n              delete data[i].y;\n            }\n            var blob = new Blob([JSON.stringify(data)], {type: \"application/json;charset=utf-8\"});\n            FileSaver.saveAs(blob, \"covi-z.json\");\n\n          })\n          .restart();\n        \n        let simulationIsRunning = true;\n\n        spatialization()\n        function spatialization() {\n          if (simulationIsRunning) {\n            document.title = 'a = ' + simulation.alpha();\n            nodes\n              .attr('x',d=>d.x)\n              .attr('y',d=>d.y);\n            requestAnimationFrame(spatialization)\n          }\n        }\n\n        document.addEventListener(\"keypress\", async function(event){\n          if (event.key==='r') {\n            simulation.alpha(1).restart();\n          }\n        });\n      })\n    })\n  }\n  render() {\n    return <svg ref={this._setRef.bind(this)} style={{ width:'100%', height:'100%'}}></svg>;\n  }\n}\n\nexport default Test;\n","import React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport * as PIXI from \"pixi.js\";\nimport { Viewport } from \"pixi-viewport\";\nimport html2canvas from 'html2canvas';\n\nimport Utilities from '../Utilities/Utilities';\n\nlet pixiApp, viewport, container, graphics,\n    width = window.innerWidth,\n    height = window.innerHeight,\n    dpr = window.devicePixelRatio || 1,\n    size = Utilities.emoji.size,\n    projection;\n\nclass PixiViz extends Component {\n  constructor(props) {\n    super(props);\n    this.loadData = this.loadData.bind(this);\n\n    this.state = {\n      textures: {}\n    }\n  }\n\n  loadData(){\n    return Promise.all([\n      d3.json('./data/covi-z.json'),\n      d3.json('./data/regioni.geojson'),\n    ])\n  }\n\n  componentDidMount() {\n    const initPixiApp = () => {\n      \n      this.loadData().then( files => {\n        let data = files[0];\n        let mapData = files[1];\n\n        pixiApp = new PIXI.Application({\n          width: width,\n          height: height,\n          backgroundColor: 0xfafafa,\n          resolution: dpr,\n          autoResize: true\n        });\n        this._rootNode.appendChild(pixiApp.view);\n    \n        // create viewport and add it to the stage\n        viewport = new Viewport({\n          center: new PIXI.Point(-window.innerWidth/2, -window.innerHeight/2),\n          passiveWheel: false,\n          stopPropagation: true,\n          divWheel: this._rootNode,\n          screenWidth: window.innerWidth,\n          screenHeight: window.innerHeight,\n          worldWidth: window.innerWidth,\n          worldHeight: window.innerHeight,\n          interaction: pixiApp.renderer.plugins.interaction // the interaction module is important for wheel to work properly when renderer.view is placed or scaled\n        });\n        viewport\n          // .moveCenter(window.innerWidth/2,window.innerHeight/2)\n          .clampZoom(Utilities.clampZoomOptions)\n          .drag({pressDrag:true, clampWheel:true})\n          .pinch()\n          .wheel()\n        pixiApp.stage.addChild(viewport);\n        \n        // Draw Italy\n        // adapted from https://gist.github.com/armollica/3598b8c89e1f18ea453231da41c7c3bc\n        projection = d3.geoConicEqualArea()\n          .fitSize([Utilities.map.width-50, Utilities.map.height-50], this._rootNode)\n          .translate([Utilities.map.width / 2, Utilities.map.height / 2])\n          .scale(3000)\n          .center([12.368775000000001, 42.9451139]);\n\n\n        for (let i=0; i<mapData.features.length; i++) {\n          const region = mapData.features[i];\n\n          const this_graphics = new PIXI.Graphics();\n\n          const path = d3.geoPath()\n            .projection(projection)\n            .context(this_graphics);\n\n          this_graphics.beginFill(0xffffff, 1);\n          this_graphics.lineStyle(0.25, 0xcccccc);\n            path(region);\n          this_graphics.endFill();\n\n          viewport.addChild(this_graphics);\n        }\n\n        // Sprites for emoji\n        container = new PIXI.Container();\n        viewport.addChild(container);\n\n        for (let i=0; i<data.length; ++i) {\n          // create a new Sprite from an image path\n          const sprite = PIXI.Sprite.from(this.state.textures[data[i].category]);\n          // center the sprite's anchor point\n          sprite.anchor.set(0.5);\n          // move the sprite to the center of the screen\n          sprite.x = data[i]._x;\n          sprite.y = data[i]._y;\n          sprite.scale.x = 1/dpr/Utilities.clampZoomOptions.maxScale;\n          sprite.scale.y = 1/dpr/Utilities.clampZoomOptions.maxScale;\n\n          container.addChild(sprite);\n        }\n      });\n    }\n\n    const icons = document.querySelectorAll('#textures-generation>span');\n    const textures = {};\n    for (let i=0; i<icons.length; ++i) {\n      html2canvas(icons[i],{backgroundColor:null}).then((canvas)=>{\n        textures[icons[i].id] = canvas.toDataURL(\"image/png\");\n        if (Object.keys(textures).length === Object.keys(Utilities.emoji_dictionary).length) {\n          this.setState({textures:textures},()=>{\n            initPixiApp();\n          })\n        }\n      });\n    }\n\n  }\n  _setRef(componentNode) {\n    this._rootNode = componentNode;\n  }\n  render() {\n    return <div style={{width:'100%',height:'100%'}} ref={this._setRef.bind(this)}>\n      {true && \n        //Object.keys(this.state.textures).length===0\n        <div id=\"textures-generation\" style={{fontSize:size+'px',position:'absolute', top:'10px'}}>\n          { Object.keys(Utilities.emoji_dictionary).map(d=>{\n            return <span id={d} key={`emoji-${d}`}>{Utilities.emoji_dictionary[d]}</span>\n          }) }\n        </div>\n      }\n    </div>;\n  }\n}\n\nexport default PixiViz;\n","const Utilities = {}\n\nUtilities.emoji = {\n    size: 20\n}\n\nUtilities.clampZoomOptions = {\n    minScale:0.5,\n    maxScale:10\n}\n\nUtilities.emoji_dictionary = {\n    \"dimessi_guariti\": '🍀',\n    \"isolamento_domiciliare\": '💮',\n    \"ricoverati_con_sintomi\": '🌼',\n    \"terapia_intensiva\": '🌸',\n    \"deceduti\": '🌺'\n};\n\nUtilities.categories = [\n    \"ricoverati_con_sintomi\",\n    \"terapia_intensiva\",\n    // \"totale_ospedalizzati\",\n    \"isolamento_domiciliare\",\n    // \"totale_attualmente_positivi\",\n    // \"nuovi_attualmente_positivi\",\n    \"dimessi_guariti\",\n    \"deceduti\",\n    // \"tamponi\"\n  ]\n\nUtilities.map = {\n    width: 768,\n    height:1024\n}\n\nexport default Utilities;\n","import React from 'react';\nimport { HashRouter, Route, Link } from \"react-router-dom\";\nimport './App.css';\n\nimport Test from './Test';\nimport PixiViz from './PixiViz';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <HashRouter basename=\"/\">\n        <Route path=\"/svg\">\n          <Test />\n        </Route>\n        <Route path=\"/pixi\">\n          <PixiViz />\n        </Route>\n        <Route exact path=\"/\">\n          {\n            <nav>\n              <ul>\n                <li>\n                  <Link to=\"/svg\">SVG Version</Link>\n                </li>\n                <li>\n                  <Link to=\"/pixi\">PIXIjs version</Link>\n                </li>\n              </ul>\n            </nav>\n          }\n        </Route>\n      </HashRouter>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}