(this["webpackJsonpcovi-z"]=this["webpackJsonpcovi-z"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var i,a,o,r,c=n(0),l=n.n(c),s=n(55),d=n.n(s),u=(n(88),n(25)),m=n(14),h=(n(89),n(31)),p=n.n(h),f=n(56),g=n(3),w=n(4),v=n(6),y=n(2),x=n(7),_=n(8),b=n(57),j=n.n(b),O={emoji:{size:20},clampZoomOptions:{minScale:.5,maxScale:10},emoji_dictionary:{dimessi_guariti:"\ud83c\udf40",isolamento_domiciliare:"\ud83d\udcae",ricoverati_con_sintomi:"\ud83c\udf3c",terapia_intensiva:"\ud83c\udf38",deceduti:"\ud83c\udf3a"},categories:["ricoverati_con_sintomi","terapia_intensiva","isolamento_domiciliare","dimessi_guariti","deceduti"]},E=O,k=_.e().stop(),z=E.emoji.size/E.clampZoomOptions.maxScale,S=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(v.a)(this,Object(y.a)(t).call(this,e))).state={data:[]},n}return Object(x.a)(t,e),Object(w.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=this;_.a("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv").then((function(t){var n=_.j().key((function(e){return e.data})).entries(t),a=n[n.length-1].values;console.log(a);var o=[];i=_.h().fitSize([window.innerWidth-200,window.innerHeight-200],e._rootNode).translate([window.innerWidth/2,window.innerHeight/2]).scale(3e3).center([12.368775000000001,42.9451139]),a.forEach((function(e){var t=i([e.long,e.lat]);e.x=t[0],e.y=t[1]}));for(var r=function(e){E.categories.forEach((function(t){for(var n=0;n<a[e][t];++n){var i={category:t,denominazione_regione:a[e].denominazione_regione,date:a[e].data,_x:a.find((function(t){return t.denominazione_regione===a[e].denominazione_regione})).x,_y:a.find((function(t){return t.denominazione_regione===a[e].denominazione_regione})).y,x:window.innerWidth*Math.random(),y:window.innerHeight*Math.random()};o.push(i)}}))},c=0;c<a.length;++c)r(c);e.setState({raw_data:a,data:o},(function(){var t=_.k(e._rootNode),n=t.append("g");t.call(_.l().extent([[0,0],[window.innerWidth,window.innerHeight]]).scaleExtent([E.clampZoomOptions.minScale,E.clampZoomOptions.maxScale]).on("zoom",(function(){n.attr("transform",_.b.transform)})));var i=n.selectAll("text").data(e.state.data).enter().append("text").attr("font-size",z+"px").text((function(e){return E.emoji_dictionary[e.category]})),a=window.prompt("Set the alpha decay of force simulation",.005);k.nodes(o).force("x",_.f((function(e){return e._x}))).force("y",_.g((function(e){return e._y}))).force("charge",_.d().strength(-.08)).force("collision",_.c(z/2*.9).iterations(4)).alphaDecay(a).alpha(1).on("end",(function(){if(i.attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})),console.log("ended",o),window.confirm("\ud83c\udf3a\ud83c\udf3f\u2618\ufe0f\ud83c\udf3c\ud83c\udf38 download spatialized data?")){for(var e=0;e<o.length;++e)o[e]._x=o[e].x,o[e]._y=o[e].y,delete o[e].index,delete o[e].vx,delete o[e].vy,delete o[e].x,delete o[e].y;var t=new Blob([JSON.stringify(o)],{type:"application/json;charset=utf-8"});j.a.saveAs(t,"covi-z.json")}})).restart(),function e(){k.alpha()>.1&&(document.title=k.alpha().toFixed(4),i.attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})),requestAnimationFrame(e))}(),document.addEventListener("keypress",function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"r"===t.key&&k.alpha(.5).restart();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}))}},{key:"render",value:function(){return console.log(this.state.data),l.a.createElement("svg",{ref:this._setRef.bind(this),style:{width:"100%",height:"100%"}})}}]),t}(c.Component),W=n(16),C=n(1),D=n(59),H=n(60),N=n.n(H),Z=window.innerWidth,R=window.innerHeight,A=window.devicePixelRatio||1,I=E.emoji.size,M=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(v.a)(this,Object(y.a)(t).call(this,e))).loadData=n.loadData.bind(Object(W.a)(n)),n.state={textures:{}},n}return Object(x.a)(t,e),Object(w.a)(t,[{key:"loadData",value:function(){return _.i("./data/covi-z.json")}},{key:"componentDidMount",value:function(){for(var e=this,t=document.querySelectorAll("#textures-generation>span"),n={},i=function(i){N()(t[i],{backgroundColor:null}).then((function(c){n[t[i].id]=c.toDataURL("image/png"),Object.keys(n).length===Object.keys(E.emoji_dictionary).length&&e.setState({textures:n},(function(){console.log(e.state),a=new C.Application({width:Z,height:R,backgroundColor:16448250,resolution:A,autoResize:!0}),e._rootNode.appendChild(a.view),(o=new D.a({center:new C.Point(-window.innerWidth/2,-window.innerHeight/2),passiveWheel:!1,stopPropagation:!0,divWheel:e._rootNode,screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:window.innerWidth,worldHeight:window.innerHeight,interaction:a.renderer.plugins.interaction})).clampZoom(E.clampZoomOptions).drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),a.stage.addChild(o),r=new C.Container,o.addChild(r),e.loadData().then((function(t){for(var n=0;n<t.length;++n){var i=C.Sprite.from(e.state.textures[t[n].category]);i.anchor.set(.5),i.x=t[n]._x,i.y=t[n]._y,i.scale.x=1/A/E.clampZoomOptions.maxScale,i.scale.y=1/A/E.clampZoomOptions.maxScale,r.addChild(i)}}))}))}))},c=0;c<t.length;++c)i(c)}},{key:"_setRef",value:function(e){this._rootNode=e}},{key:"render",value:function(){return l.a.createElement("div",{style:{width:"100%",height:"100%"},ref:this._setRef.bind(this)},l.a.createElement("div",{id:"textures-generation",style:{fontSize:I+"px",position:"absolute",top:"10px"}},Object.keys(E.emoji_dictionary).map((function(e){return l.a.createElement("span",{id:e,key:"emoji-".concat(e)},E.emoji_dictionary[e])}))))}}]),t}(c.Component);var P=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(u.a,{basename:"/"},l.a.createElement(m.a,{path:"/svg"},l.a.createElement(S,null)),l.a.createElement(m.a,{path:"/pixi"},l.a.createElement(M,null)),l.a.createElement(m.a,{exact:!0,path:"/"},l.a.createElement("nav",null,l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(u.b,{to:"/svg"},"SVG Version")),l.a.createElement("li",null,l.a.createElement(u.b,{to:"/pixi"},"PIXIjs version")))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.render(l.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},83:function(e,t,n){e.exports=n(105)},88:function(e,t,n){},89:function(e,t,n){}},[[83,1,2]]]);
//# sourceMappingURL=main.9743e9d4.chunk.js.map