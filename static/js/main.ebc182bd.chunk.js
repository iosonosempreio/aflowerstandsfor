(this["webpackJsonpcovi-z"]=this["webpackJsonpcovi-z"]||[]).push([[0],{124:function(e,t,i){e.exports=i(161)},129:function(e,t,i){},130:function(e,t,i){},161:function(e,t,i){"use strict";i.r(t);var n,a,r,o,s,c,l,d,u,h,m,p,f=i(0),v=i.n(f),g=i(88),_=i.n(g),w=(i(129),i(23)),y=i(16),b=(i(130),i(9)),x=i.n(b),k=i(12),j=i(3),L=i(4),P=i(7),N=i(5),O=i(6),E=i(2),C=i(30),z=(i(132),{emoji:{size:20},clampZoomOptions:{minScale:.01,maxScale:7},emoji_dictionary:{dimessi_guariti:"\ud83c\udf40",isolamento_domiciliare:"\u26aa\ufe0f",ricoverati_con_sintomi:"\ud83c\udf3c",terapia_intensiva:"\ud83c\udf38",deceduti:"\ud83c\udf3a"},emoji_images_dictionary:{dimessi_guariti:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/four-leaf-clover_1f340.png",isolamento_domiciliare:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/blossom_1f33c.png",ricoverati_con_sintomi:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/sunflower_1f33b.png",terapia_intensiva:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/cherry-blossom_1f338.png",deceduti:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/hibiscus_1f33a.png"},categories:["deceduti","terapia_intensiva","ricoverati_con_sintomi","isolamento_domiciliare","dimessi_guariti"],categories_en:["deceased","intensive_care","hospitalized","home_isolation","recovered"],category2english:{deceduti:"deceased",terapia_intensiva:"intensive_care",ricoverati_con_sintomi:"hospitalized",isolamento_domiciliare:"home_isolation",dimessi_guariti:"recovered"},map:{width:768,height:1024,scale:3e4},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}}),S=z,D=[{region_name:"Abruzzo",lat:"42.216666666667",lon:"13.833333333333"},{region_name:"Valle d'Aosta",lat:"45.716666666667",lon:"7.3666666666667"},{region_name:"Puglia",lat:"41.008611111111",lon:"16.512777777778"},{region_name:"Basilicata",lat:"40.5",lon:"16.5"},{region_name:"Calabria",lat:"39",lon:"16.5"},{region_name:"Campania",lat:"40.75",lon:"14.783333333333"},{region_name:"Emilia-Romagna",lat:"44.75",lon:"11"},{region_name:"Friuli Venezia Giulia",lat:"46.1",lon:"13.116666666667"},{region_name:"Lazio",lat:"41.9",lon:"12.716666666667"},{region_name:"Liguria",lat:"44.45",lon:"8.7666666666667"},{region_name:"Lombardia",lat:"45.65",lon:"9.95"},{region_name:"Marche",lat:"43.316666666667",lon:"13"},{region_name:"Molise",lat:"41.6997",lon:"14.6111"},{region_name:"Piemonte",lat:"45.25",lon:"7.9166666666667"},{region_name:"Sardegna",lat:"40.05",lon:"9.0833333333333"},{region_name:"Sicilia",lat:"37.599958333333",lon:"14.015377777778"},{region_name:"Trentino-Alto Adige",lat:"46.383333333333",lon:"11.416666666667"},{region_name:"Toscana",lat:"43.35",lon:"11.016666666667"},{region_name:"Umbria",lat:"42.983333333333",lon:"12.566666666667"},{region_name:"Veneto",lat:"45.733333333333",lon:"11.85"}],T={deceduti:"deceased",terapia_intensiva:"intensive_cares",ricoverati_con_sintomi:"hospitalized",isolamento_domiciliare:"home_isolation",dimessi_guariti:"recovered"},M={deceduti:"1",terapia_intensiva:"2",ricoverati_con_sintomi:"3",isolamento_domiciliare:"4",dimessi_guariti:"5"},A=(E.g().stop(),{}),I=E.j(),B=E.k().projection(I),R=E.p().exponent(.5),W=E.o(E.q),q=function(e){function t(e){return Object(j.a)(this,t),Object(P.a)(this,Object(N.a)(t).call(this,e))}return Object(O.a)(t,e),Object(L.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=Object(k.a)(x.a.mark((function e(){var t,i,r,o,s,c,l,d,u,h,m,p,f,v;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=function(e){for(var t=e.length-1;t>0;t--){var i=Math.floor(Math.random()*(t+1)),n=[e[i],e[t]];e[t]=n[0],e[i]=n[1]}return e},f=function(e){A[e].filter((function(e){return"Lombardia"===e.denominazione_regione})).forEach((function(t){var i=d[e].filter((function(e){return e.id.toString().substring(0,2)===t.code}));console.log(i.length),v(i);var n=u[e].filter((function(e){return e.source.toString().substring(0,2)===t.code})),a=E.g(i).force("center",E.c(0,0)).force("links",E.e([]).id((function(e){return e.id})).distance(0).strength(.01).iterations(8)).force("charge",E.f().strength(-.01)).force("collision",E.d(.35).strength(1)).force("x",E.h()).force("y",E.i()).on("tick",(function(){document.title=a.alpha(),r.each((function(e,t){var i=Math.hypot(e.x,e.y),n=A[m].find((function(t){return t.code===e.id.substring(0,2)})).r;if(i>n){e.y;var a=e.x/i,r=e.y/e.x,o=Math.atan(r),s=Math.cos(o)*n,c=Math.sin(o)*n;a<0&&(s*=-1,c*=-1),e.x=s,e.y=c}})).attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y}))})).alphaMin(.01).on("end",(function(){console.log(t.denominazione_regione,"simulation ended"),r.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),i.forEach((function(e){e.bunches_x=e.x,e.bunches_y=e.y})),a.force("links").links(n),a.alpha(1).restart().on("end",(function(){document.title="simulation ended",r.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),i.forEach((function(e){e.clusters_x=e.x,e.clusters_y=e.y})),console.log(t.denominazione_regione,"simulation clusters ended")}))})),r=p.append("g").attr("transform","translate("+t.x+","+t.y+")").attr("class",t.code).selectAll(".flower");r=r.data(i,(function(e){return e.id})).enter().append("circle").classed("flower",!0).attr("r",.5).attr("fill",(function(e){return W(e.id.toString().substring(2,4))})).style("opacity",.7).attr("cx",t.x).attr("cy",t.y)}))},t=E.r(this._rootNode),i=t.append("g"),r=E.s().on("zoom",(function(){i.attr("transform",E.b.transform)})),t.call(r),e.next=8,E.l("./data/world-50m.json");case 8:return o=e.sent,s=C.a(o,o.objects.countries),c=s.features.find((function(e){return"380"===e.id})),I.fitExtent([[5,5],[758,1014]],c),(n=(n=i.append("g").attr("class","countries").selectAll(".country")).data(s.features)).exit().remove(),n.enter().append("path").classed("country",!0).merge(n).attr("d",B).attr("fill","#fafafa").attr("stroke","#eef3bd").attr("stroke-width","0.5px"),e.next=18,E.a("./data/dpc-covid19-ita-regioni.csv");case 18:l=e.sent,R.range([0,70]).domain([0,E.m(l,(function(e){return Number(e.totale_casi)}))]),d={},u={},h=E.n().key((function(e){return e.data})).entries(l),m="2020-02-24T18:00:00",m="2020-03-10T18:00:00",(h=h.filter((function(e){return e.key===m}))).forEach((function(e){console.log(e),d[e.key]=[],u[e.key]=[],A[e.key]=[];var t=e.values,i=t.filter((function(e){return"04"===e.codice_regione})),n={data:e.key,stato:"ITA",codice_regione:"04",denominazione_regione:"Trentino-Alto Adige",lat:"46.49933453",long:"11.35662422",ricoverati_con_sintomi:Number(i[0].ricoverati_con_sintomi)+Number(i[1].ricoverati_con_sintomi),terapia_intensiva:Number(i[0].terapia_intensiva)+Number(i[1].terapia_intensiva),totale_ospedalizzati:Number(i[0].totale_ospedalizzati)+Number(i[1].totale_ospedalizzati),isolamento_domiciliare:Number(i[0].isolamento_domiciliare)+Number(i[1].isolamento_domiciliare),totale_positivi:Number(i[0].totale_positivi)+Number(i[1].totale_positivi),variazione_totale_positivi:Number(i[0].variazione_totale_positivi)+Number(i[1].variazione_totale_positivi),nuovi_positivi:Number(i[0].nuovi_positivi)+Number(i[1].nuovi_positivi),dimessi_guariti:Number(i[0].dimessi_guariti)+Number(i[1].dimessi_guariti),deceduti:Number(i[0].deceduti)+Number(i[1].deceduti),totale_casi:Number(i[0].totale_casi)+Number(i[1].totale_casi),tamponi:Number(i[0].tamponi)+Number(i[1].tamponi),note_it:"",note_en:""},a=t.indexOf(i[0]);t.splice(a,1);var r=t.indexOf(i[1]);t.splice(r,1),t.push(n),t.forEach((function(t){t.code=t.codice_regione,t.total=t.totale_casi,t.center_x=D.find((function(e){return e.region_name===t.denominazione_regione})).lon,t.center_y=D.find((function(e){return e.region_name===t.denominazione_regione})).lat,t.r=R(Number(t.total));var i=I([t.center_x,t.center_y]);t.x=i[0],t.y=i[1],delete t.data,delete t.codice_regione,delete t.stato,delete t.lat,delete t.long,delete t.totale_casi,delete t.totale_ospedalizzati,delete t.totale_positivi,delete t.variazione_totale_positivi,delete t.nuovi_positivi,delete t.tamponi,delete t.note_it,delete t.note_en,A[e.key].push(t),Object.keys(T).forEach((function(i){for(var n=0;n<t[i];++n){var a={id:t.code.toString()+""+M[i]+n.toString().padStart(6,"0")};if(d[e.key].push(a),0===n)for(var r=1;r<Number(M[i]);++r){var o={source:t.code.toString()+""+r+"0".toString().padStart(6,"0"),target:a.id};u[e.key].push(o)}else{var s={source:t.code.toString()+""+M[i]+"0".toString().padStart(6,"0"),target:a.id};u[e.key].push(s)}}}))}))})),a=(a=i.selectAll(".region")).data(A[m],(function(e){return e.code})).enter().append("circle").attr("class",(function(e){return e.denominazione_regione})).attr("fill","white").attr("stroke","#cccccc").classed("region",!0).attr("r",(function(e){return R(+e.total)})),E.g(A[m]).force("x",E.h((function(e){return e.x}))).force("y",E.i((function(e){return e.y}))).force("collision",E.d((function(e){return R(e.total)}))).on("tick",(function(){a.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y}))})).on("end",(function(){f(m)})).alpha(1).restart(),p=i.append("g").classed("flowers",!0);case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return v.a.createElement("svg",{ref:this._setRef.bind(this),style:{width:"768px",height:"1024px",backgroundColor:"#eef3bd"}})}}]),t}(f.Component),V=i(1),H=i(20),F=window.devicePixelRatio||1,G=[],U=0,X=(E.j().translate([S.map.width/2,S.map.height/2]).scale(S.map.scale).center([12.368775000000001,42.9451139]),function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).state={viewBuffer:null},i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=this;r=window.innerWidth/F,o=window.innerHeight/F;var t=Object.keys(this.props.unique_IDS).length;console.log("amount:",t),s=new V.Application({width:r,height:o,backgroundColor:16056305,resolution:F,powerPreference:"high-performance"}),this._rootNode.appendChild(s.view);var i=new H.a({passiveWheel:!1,stopPropagation:!0,divWheel:this._rootNode,screenWidth:r,screenHeight:o,worldWidth:r,worldHeight:o,interaction:s.renderer.plugins.interaction});i.drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),s.stage.addChild(i);var n=new V.ParticleContainer(t,{vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!1});i.addChild(n);var a={};s.loader.add("sprites","./flowers-textures-ita-1.png"),s.loader.onProgress.add((function(e){console.log(e.progress+"%")})),s.loader.onComplete.add(Object(k.a)(x.a.mark((function t(){var r,o,c,l,d,u,h,m;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loader completed"),r=s.loader.resources.sprites.texture.baseTexture,t.next=4,E.l("./flowers-textures-ita-1.json");case 4:for(c in(o=t.sent).frames)l=o.frames[c].frame,d=new V.Texture(r,new V.Rectangle(l.x,l.y,l.w,l.h)),a[c.replace(".png","")]=d;for(h in u={},e.props.unique_IDS)(m=new J(a[e.props.unique_IDS[h].category])).x=Number(e.props.unique_IDS[h].position.x),m.y=Number(e.props.unique_IDS[h].position.y),m.anchor.x=.5,m.anchor.y=.5,m.scale.x=.125,m.scale.y=.125,u[h]=m;e.state.viewBuffer=new Y(u,n),e.state.viewBuffer.setDrawList(e.props.data,e.props.model),e.state.viewBuffer.drawObjects(),U=Date.now(),function e(){var t=(Date.now()-U)/1e3;U=Date.now();for(var n=0;n<G.length;++n)G[n](t);s.renderer.render(i),requestAnimationFrame(e)}();case 14:case"end":return t.stop()}}),t)})))),s.loader.load()}},{key:"componentDidUpdate",value:function(e){e.data!==this.props.data?(this.state.viewBuffer.clearObjects(),this.state.viewBuffer.setDrawList(this.props.data,this.props.model),this.state.viewBuffer.drawObjects()):e.model!==this.props.model&&(this.state.viewBuffer.model=this.props.model,this.state.viewBuffer.startAnimation(5,s))}},{key:"render",value:function(){return v.a.createElement("div",{style:{width:"100vw",height:"100vh"},ref:this._setRef.bind(this)})}}]),t}(f.Component)),Y=function(){function e(t,i){Object(j.a)(this,e),this.master={},this.drawList=[],this.animationTime=0,this.timeLeft=0,this.app=null,this.container=null,this.model=null,this.master=t,this.container=i}return Object(L.a)(e,[{key:"setDrawList",value:function(e,t){this.drawList=e,this.model=t}},{key:"clearObjects",value:function(){this.container.removeChildren()}},{key:"drawObjects",value:function(){if("stripes"!==this.model)for(var e=0;e<this.drawList.length;++e)this.master[this.drawList[e].id].position.x=Number(this.drawList[e][this.model+"_x"]),this.master[this.drawList[e].id].position.y=Number(this.drawList[e][this.model+"_y"]),this.container.addChild(this.master[this.drawList[e].id]);else for(var t=0;t<this.drawList.length;++t)this.master[this.drawList[t].id].position.x=Number(this.drawList[t][this.model+"_x"])*r,this.master[this.drawList[t].id].position.y=Number(this.drawList[t][this.model+"_y"])*o,this.container.addChild(this.master[this.drawList[t].id])}},{key:"startAnimation",value:function(e,t){if(this.animationTime=e,this.timeLeft=0,this.app=t,"stripes"===this.model)for(var i=0;i<this.drawList.length;++i){var n=new V.Point;n.x=Number(this.drawList[i][this.model+"_x"])*r,n.y=Number(this.drawList[i][this.model+"_y"])*o,this.master[this.drawList[i].id].setLastPoint(),this.master[this.drawList[i].id].setNextPoint(n)}else for(var a=0;a<this.drawList.length;++a){var s=new V.Point;s.x=Number(this.drawList[a][this.model+"_x"]),s.y=Number(this.drawList[a][this.model+"_y"]),this.master[this.drawList[a].id].setLastPoint(),this.master[this.drawList[a].id].setNextPoint(s)}G.push(this.animate.bind(this))}},{key:"animate",value:function(e){if(this.timeLeft+=e,this.timeLeft>=this.animationTime)G.pop();else for(var t=S.easeInOutCubic(this.timeLeft/this.animationTime),i=0;i<this.drawList.length;++i)this.master[this.drawList[i].id].moveToNextPoint(t)}}]),e}(),J=function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).nextPoint=new V.Point,i.lastPoint=new V.Point,i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"setNextPoint",value:function(e){this.nextPoint=e}},{key:"setLastPoint",value:function(){this.lastPoint=this.position}},{key:"moveToNextPoint",value:function(e){this.position.x=(1-e)*this.lastPoint.x+e*this.nextPoint.x,this.position.y=(1-e)*this.lastPoint.y+e*this.nextPoint.y}}]),t}(V.Sprite),Z=X,K=i(18),$=function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).state={data:null,play:!1,unique_IDS:{}},i.changeDate=i.changeDate.bind(Object(K.a)(i)),i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"changeDate",value:function(e){e<0?e=this.state.dates.length-1:e>this.state.dates.length-1&&(e=0);var t=this.state.dates[e];this.setState({current_date:t,current_date_index:e,data_day:this.state.data[t]})}},{key:"changeModel",value:function(e){this.setState({model:e})}},{key:"componentDidMount",value:function(){var e=Object(k.a)(x.a.mark((function e(){var t,i,n,a,r,o,s,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([E.a("./data/list-daily-datasets.csv"),E.l("./data/regioni.geojson")]);case 2:return t=e.sent,i=t[0].map((function(e){return e.date})),n={},e.next=7,Promise.all(t[0].map((function(e){return E.a("./data/"+e.file_name)})));case 7:for(a=e.sent,r=0;r<i.length;r++){for(o=0;o<a[r].length;o++)(s=a[r][o]).x=Number(s.origin_x),s.y=Number(s.origin_y),s.id in this.state.unique_IDS||(this.state.unique_IDS[s.id]={category:s.category,position:{x:s.bunches_x,y:s.bunches_y}});n[i[r]]=a[r]}return i.length-1,0,c=n[i[0]],e.next=14,this.setState({data:n,dates:i,current_date:i[0],current_date_index:0,data_day:c,model:"bunches",mapGeometries:t[1]});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return v.a.createElement("div",{ref:this._setRef.bind(this)},this.state.data&&v.a.createElement(Z,{data:this.state.data_day.reverse(),model:this.state.model,mapGeometries:this.state.mapGeometries,play:this.state.play,current_date_index:this.state.current_date_index,changeDate:this.changeDate,unique_IDS:this.state.unique_IDS}),v.a.createElement("header",{style:{position:"fixed",top:0}},v.a.createElement("p",null,v.a.createElement("input",{type:"button",name:"prev-date",value:"\u23ea",onClick:function(){return e.changeDate(e.state.current_date_index-1)}}),v.a.createElement("input",{type:"button",name:"prev-date",value:"\u25b6\ufe0f",onClick:function(){return e.setState({play:!e.state.play},e.changeDate(e.state.current_date_index+1))}}),v.a.createElement("input",{type:"button",name:"prev-date",value:"\u23e9",onClick:function(){return e.changeDate(e.state.current_date_index+1)}}),v.a.createElement("input",{type:"button",name:"bands",value:"\ud83d\uddbc",onClick:function(){return e.changeModel("stripes")}}),v.a.createElement("input",{type:"button",name:"bunch",value:"\ud83d\udc90",onClick:function(){return e.changeModel("bunches")}}),v.a.createElement("input",{type:"button",name:"clusters",value:"\ud83c\udfaf",onClick:function(){return e.changeModel("clusters")}}),this.state.current_date)))}}]),t}(f.Component),Q=new(i(90).GPU),ee=window.devicePixelRatio||1,te=function(e){function t(){return Object(j.a)(this,t),Object(P.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(O.a)(t,e),Object(L.a)(t,[{key:"componentDidMount",value:function(){var e=window.innerWidth/ee,t=window.innerHeight/ee;V.Ticker.shared.stop();var i=new V.Application({autoStart:!1,width:e,height:t,backgroundColor:16056305,resolution:ee,powerPreference:"high-performance",sharedTicker:!1});this._rootNode.appendChild(i.view);var n=new H.a({passiveWheel:!1,stopPropagation:!0,divWheel:this._rootNode,screenWidth:e,screenHeight:t,worldWidth:e,worldHeight:t,interaction:i.renderer.plugins.interaction});n.drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),i.stage.addChild(n);var a=new V.ParticleContainer(2e5,{vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!1});n.addChild(a);var r=[];i.loader.add("sprites","./flowers-textures-1.png"),i.loader.onProgress.add((function(e){console.log(e.progress+"%")})),i.loader.onComplete.add(Object(k.a)(x.a.mark((function o(){var s,c,l,d,u,h,m,p,f,v,g,_,w;return x.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log("loader completed"),s=i.loader.resources.sprites.texture.baseTexture,o.next=4,E.l("./flowers-textures-1.json");case 4:for(l in(c=o.sent).frames)d=c.frames[l].frame,u=new V.Texture(s,new V.Rectangle(d.x,d.y,d.w,d.h)),r.push(u);for(h=[],[],[],m=0;m<2e5;++m)p=new ie(r[m%5]),f=e*Math.random(),v=t*Math.random(),g=-.5+Math.random(),_=-.5+Math.random(),p.x=f,p.y=v,p.speedX=g,p.speedY=_,w=[f,v,g,_],h.push(w),p.anchor.x=.5,p.anchor.y=.5,p.scale.x=.125,p.scale.y=.125,a.addChild(p);Q.createKernel((function(e,t){var i=e[this.thread.x][2],n=e[this.thread.x][0]+i;n<0?(n=0,i*=-1):n>t[0]&&(n=t[0],i*=-1);var a=e[this.thread.x][3],r=e[this.thread.x][1]+a;return r<0?(r=0,a*=-1):r>t[1]&&(r=t[1],a*=-1),[n,r,i,a]})).setOutput([2e5]),0,function r(){0;for(var o=0;o<2e5;o++){var s=a.children[o];s.x+=s.speedX,s.x>e?(s.speedX*=-1,s.x=e):s.x<0&&(s.speedX*=-1,s.x=0),s.y+=s.speedY,s.y>t?(s.speedY*=-1,s.y=t):s.y<0&&(s.speedY*=-1,s.y=0)}i.renderer.render(n),requestAnimationFrame(r)}();case 14:case"end":return o.stop()}}),o)})))),i.loader.load()}},{key:"_setRef",value:function(e){this._rootNode=e}},{key:"render",value:function(){return v.a.createElement("div",{ref:this._setRef.bind(this)})}}]),t}(f.Component),ie=function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).nextPoint=new V.Point,i.lastPoint=new V.Point,i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"setNextPoint",value:function(e){this.nextPoint=e}},{key:"setLastPoint",value:function(){this.lastPoint=this.position}},{key:"moveToNextPoint",value:function(e){this.position.x=(1-e)*this.lastPoint.x+e*this.nextPoint,this.position.y=(1-e)*this.lastPoint.y+e*this.nextPoint}}]),t}(V.Sprite),ne=te,ae=window.devicePixelRatio||1,re=window.innerWidth,oe=window.innerHeight,se=E.j(),ce=E.k(),le=[],de=0,ue=function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).state={model:"bunches",viewBuffer:null,day:"none",day_index:-1},i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=this,t={};(p=Object.keys(this.props.data)).forEach((function(i){for(var n=0;n<e.props.data[i].length;++n){var a=e.props.data[i][n];a.id in t||(t[a.id]={})}}));var i=Object.keys(t);c=new V.Application({width:re,height:oe,backgroundColor:16448250,autoDensity:!0,resolution:ae,powerPreference:"high-performance",antialias:!1,sharedTicker:!1,autoStart:!1}),V.Ticker.shared.stop(),this._rootNode.querySelector("#visualization").appendChild(c.view),(l=new H.a({passiveWheel:!1,stopPropagation:!0,divWheel:this._rootNode,screenWidth:re,screenHeight:oe,worldWidth:re,worldHeight:oe,interaction:c.renderer.plugins.interaction})).clampZoom({minScale:.75,maxScale:5}).drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),c.stage.addChild(l),u=new V.Container,l.addChild(u);var n=this.props.topojson,a=C.a(n,n.objects.countries),r=a.features.find((function(t){return t.id===e.props.country_info.country_code}));se.fitExtent([[5,5],[758,1014]],r),a.features.filter((function(t){return t.id===e.props.country_info.country_code})).forEach((function(e){var t=new V.Graphics;ce.projection(se).context(t),t.beginFill(14680022,1),t.lineStyle(1,16448250,.5),ce(e),t.endFill(),u.addChild(t)})),(h=new V.Container).renderable=!1,l.addChild(h),d=new V.ParticleContainer(i.length,{scale:!0,vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!1}),l.addChild(d),c.loader.add("flowersTextures","./flowers-textures-1.json"),c.loader.onComplete.add((function(){m=c.loader.resources.flowersTextures.textures;for(var t={},n=0;n<i.length;++n){var a=i[n],r=e.props.country_info.categories_codes[a.substring(2,3)]+".png",o=new me(m[r]);o.x=50,o.y=50,o.anchor.x=.5,o.anchor.y=.5;o.scaleValues=[1/m[r].orig.width*10,1/m[r].orig.height*10],o.scale.x=o.scaleValues[0],o.scale.y=o.scaleValues[1],t[a]=o}var s=new he(t,d),u=p.length-1;e.setState({day:p[u],day_index:u,viewBuffer:s}),l.on("zoomed",(function(){s.rescaleObjects(l.transform.scale._x)})),de=Date.now();!function e(){var t=(Date.now()-de)/1e3;de=Date.now();for(var i=0;i<le.length;++i)le[i](t);c.renderer.render(l),requestAnimationFrame(e)}()})),c.loader.load()}},{key:"componentDidUpdate",value:function(e,t){t.day_index!==this.state.day_index?(this.state.viewBuffer.drawRegionsInfo(this.props.regionsInfo[p[this.state.day_index]]),this.state.viewBuffer.clearObjects(),this.state.viewBuffer.setDrawList(this.props.data[p[this.state.day_index]],this.state.model),this.state.viewBuffer.drawObjects()):t.model!==this.state.model&&(this.state.viewBuffer.model=this.state.model,this.state.viewBuffer.startAnimation(5,c))}},{key:"changeDate",value:function(e){e<0?e=p.length-1:e>p.length-1&&(e=0);var t=p[e];this.setState({day:t,day_index:e})}},{key:"changeModel",value:function(e){this.setState({model:e})}},{key:"render",value:function(){var e=this;return v.a.createElement("div",{style:{width:"100%",height:"100%"},ref:this._setRef.bind(this)},v.a.createElement("div",{id:"visualization"}),v.a.createElement("div",{id:"controls",style:{position:"fixed",top:0}},v.a.createElement("p",null,v.a.createElement("input",{type:"button",name:"prev-date",value:"previous day",onClick:function(){return e.changeDate(e.state.day_index-1)}}),this.state.day&&v.a.createElement("span",null,this.state.day),v.a.createElement("input",{type:"button",name:"prev-date",value:"next day",onClick:function(){return e.changeDate(e.state.day_index+1)}}),v.a.createElement("input",{type:"button",name:"bands",value:"stripes",onClick:function(){return e.changeModel("stripes")}}),v.a.createElement("input",{type:"button",name:"bunch",value:"bunches",onClick:function(){return e.changeModel("bunches")}}),v.a.createElement("input",{type:"button",name:"clusters",value:"clusters",onClick:function(){return e.changeModel("clusters")}}))))}}]),t}(f.Component),he=function(){function e(t,i){Object(j.a)(this,e),this.master={},this.drawList=[],this.animationTime=0,this.timeLeft=0,this.app=null,this.container=null,this.model=null,this.master=t,this.container=i}return Object(L.a)(e,[{key:"setDrawList",value:function(e,t){this.drawList=e,this.model=t}},{key:"clearObjects",value:function(){this.container.removeChildren()}},{key:"drawObjects",value:function(){if("stripes"!==this.model)for(var e=0;e<this.drawList.length;++e)this.master[this.drawList[e].id].position.x=Number(this.drawList[e][this.model+"_x"]),this.master[this.drawList[e].id].position.y=Number(this.drawList[e][this.model+"_y"]),this.container.addChild(this.master[this.drawList[e].id]);else for(var t=0;t<this.drawList.length;++t)this.master[this.drawList[t].id].position.x=Number(this.drawList[t][this.model+"_x"])*(re-40)+20,this.master[this.drawList[t].id].position.y=Number(this.drawList[t][this.model+"_y"])*(oe-40)+20,this.container.addChild(this.master[this.drawList[t].id])}},{key:"rescaleObjects",value:function(e){for(var t=0;t<this.drawList.length;++t){var i=this.master[this.drawList[t].id];i.scale.x=i.scaleValues[0]/e,i.scale.y=i.scaleValues[1]/e}}},{key:"drawRegionsInfo",value:function(e){h.removeChildren(),e.forEach((function(e){var t=new V.Graphics;t.lineStyle(1,16711680,.5),t.drawCircle(Number(e.x),Number(e.y),Number(e.r)),h.addChild(t);var i=new V.Text(e.denominazione_regione+"-"+e.total,{fontFamily:"Arial",fontSize:10,fill:16715792,align:"left"});i.x=Number(e.x),i.y=Number(e.y),h.addChild(i)}))}},{key:"startAnimation",value:function(e,t){if(this.animationTime=e,this.timeLeft=0,this.app=t,"stripes"===this.model)for(var i=0;i<this.drawList.length;++i){var n=new V.Point;n.x=Number(this.drawList[i][this.model+"_x"])*(re-40)+20,n.y=Number(this.drawList[i][this.model+"_y"])*(oe-40)+20,this.master[this.drawList[i].id].setLastPoint(),this.master[this.drawList[i].id].setNextPoint(n)}else for(var a=0;a<this.drawList.length;++a){var r=new V.Point;r.x=Number(this.drawList[a][this.model+"_x"]),r.y=Number(this.drawList[a][this.model+"_y"]),this.master[this.drawList[a].id].setLastPoint(),this.master[this.drawList[a].id].setNextPoint(r)}le.push(this.animate.bind(this))}},{key:"animate",value:function(e){if(this.timeLeft+=e,this.timeLeft>=this.animationTime)le.pop();else for(var t=S.easeInOutCubic(this.timeLeft/this.animationTime),i=0;i<this.drawList.length;++i)this.master[this.drawList[i].id].moveToNextPoint(t)}}]),e}(),me=function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).nextPoint=new V.Point,i.lastPoint=new V.Point,i.originalScale=null,i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"setNextPoint",value:function(e){this.nextPoint=e}},{key:"setLastPoint",value:function(){this.lastPoint=this.position}},{key:"moveToNextPoint",value:function(e){this.position.x=(1-e)*this.lastPoint.x+e*this.nextPoint.x,this.position.y=(1-e)*this.lastPoint.y+e*this.nextPoint.y}}]),t}(V.Sprite),pe=ue,fe=function(e){function t(e){var i;return Object(j.a)(this,t),(i=Object(P.a)(this,Object(N.a)(t).call(this,e))).state={},i}return Object(O.a)(t,e),Object(L.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=Object(k.a)(x.a.mark((function e(){var t,i,n,a,r,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([E.a("./data/italy/datasets.csv"),E.l("./data/world-50m.json")]);case 2:return t=e.sent,e.next=5,Promise.all(t[0].map((function(e){return E.a("./data/italy/"+e.file_name)})));case 5:return i=e.sent,e.next=8,Promise.all(t[0].map((function(e){return E.a("./data/italy/"+e.file_name.replace(".csv","-regions.csv"))})));case 8:n=e.sent,a={},r={},t[0].map((function(e){return e.date})).forEach((function(e,t){a[e]=i[t],r[e]=n[t]})),o=t[1],this.setState({data:a,regionsInfo:r,topojson:o});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return v.a.createElement("div",{className:"italy",ref:this._setRef.bind(this)},!this.state.data&&v.a.createElement("div",null,"Loading data..."),this.state.data&&v.a.createElement(pe,{data:this.state.data,regionsInfo:this.state.regionsInfo,topojson:this.state.topojson,country_info:ve}))}}]),t}(f.Component),ve={country_code:"380",regions_codes:{13:"Abruzzo",17:"Basilicata",18:"Calabria",15:"Campania","08":"Emilia-Romagna","06":"Friuli Venezia Giulia",12:"Lazio","07":"Liguria","03":"Lombardia",11:"Marche",14:"Molise","01":"Piemonte",16:"Puglia",20:"Sardegna",19:"Sicilia","09":"Toscana","04":"Trentino-Alto Adige",10:"Umbria","02":"Valle d'Aosta","05":"Veneto"},categories_codes:{1:"deceased",2:"intensive_cares",3:"hospitalized",4:"home_isolation",5:"recovered"}};var ge=function(){return v.a.createElement("div",{className:"App"},v.a.createElement(w.a,{basename:"/"},v.a.createElement(y.a,{exact:!0,path:"/"},v.a.createElement("nav",null,v.a.createElement("ul",null,v.a.createElement("li",null,v.a.createElement(w.b,{to:"/performances"},"Testing PIXIjs performances")),v.a.createElement("li",null,v.a.createElement(w.b,{to:"/viz"},"Visualization")),v.a.createElement("li",null,v.a.createElement(w.b,{to:"/italy"},"Italy"))))),v.a.createElement(y.a,{path:"/svg"},v.a.createElement(q,null)),v.a.createElement(y.a,{path:"/pixi"},v.a.createElement(Z,null)),v.a.createElement(y.a,{path:"/viz"},v.a.createElement($,null)),v.a.createElement(y.a,{path:"/performances"},v.a.createElement(ne,null)),v.a.createElement(y.a,{path:"/italy"},v.a.createElement(fe,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));_.a.render(v.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[124,1,2]]]);
//# sourceMappingURL=main.ebc182bd.chunk.js.map