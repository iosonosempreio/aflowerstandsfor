(this["webpackJsonpcovi-z"]=this["webpackJsonpcovi-z"]||[]).push([[0],{124:function(e,t,a){e.exports=a(164)},129:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){},158:function(e,t,a){},164:function(e,t,a){"use strict";a.r(t);var n,i,r,o,s,l,c,u,d,h,m,p,f=a(0),v=a.n(f),g=a(88),y=a.n(g),_=(a(129),a(130),a(3)),b=a(4),w=a(7),x=a(5),E=a(16),k=a(6),j=a(10),L=a(18),N=(a(131),a(9)),O=a.n(N),P=a(13),C=a(2),S=a(30),z=(a(133),{emoji:{size:20},clampZoomOptions:{minScale:.01,maxScale:7},emoji_dictionary:{dimessi_guariti:"\ud83c\udf40",isolamento_domiciliare:"\u26aa\ufe0f",ricoverati_con_sintomi:"\ud83c\udf3c",terapia_intensiva:"\ud83c\udf38",deceduti:"\ud83c\udf3a"},emoji_images_dictionary:{dimessi_guariti:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/four-leaf-clover_1f340.png",isolamento_domiciliare:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/blossom_1f33c.png",ricoverati_con_sintomi:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/sunflower_1f33b.png",terapia_intensiva:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/cherry-blossom_1f338.png",deceduti:"https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/144/whatsapp/238/hibiscus_1f33a.png"},categories:["deceduti","terapia_intensiva","ricoverati_con_sintomi","isolamento_domiciliare","dimessi_guariti"],categories_en:["deceased","intensive_care","hospitalized","home_isolation","recovered"],category2english:{deceduti:"deceased",terapia_intensiva:"intensive_care",ricoverati_con_sintomi:"hospitalized",isolamento_domiciliare:"home_isolation",dimessi_guariti:"recovered"},map:{width:768,height:1024,scale:3e4},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}}),D=z,A=[{region_name:"Abruzzo",lat:"42.216666666667",lon:"13.833333333333"},{region_name:"Valle d'Aosta",lat:"45.716666666667",lon:"7.3666666666667"},{region_name:"Puglia",lat:"41.008611111111",lon:"16.512777777778"},{region_name:"Basilicata",lat:"40.5",lon:"16.5"},{region_name:"Calabria",lat:"39",lon:"16.5"},{region_name:"Campania",lat:"40.75",lon:"14.783333333333"},{region_name:"Emilia-Romagna",lat:"44.75",lon:"11"},{region_name:"Friuli Venezia Giulia",lat:"46.1",lon:"13.116666666667"},{region_name:"Lazio",lat:"41.9",lon:"12.716666666667"},{region_name:"Liguria",lat:"44.45",lon:"8.7666666666667"},{region_name:"Lombardia",lat:"45.65",lon:"9.95"},{region_name:"Marche",lat:"43.316666666667",lon:"13"},{region_name:"Molise",lat:"41.6997",lon:"14.6111"},{region_name:"Piemonte",lat:"45.25",lon:"7.9166666666667"},{region_name:"Sardegna",lat:"40.05",lon:"9.0833333333333"},{region_name:"Sicilia",lat:"37.599958333333",lon:"14.015377777778"},{region_name:"Trentino-Alto Adige",lat:"46.383333333333",lon:"11.416666666667"},{region_name:"Toscana",lat:"43.35",lon:"11.016666666667"},{region_name:"Umbria",lat:"42.983333333333",lon:"12.566666666667"},{region_name:"Veneto",lat:"45.733333333333",lon:"11.85"}],T={deceduti:"deceased",terapia_intensiva:"intensive_cares",ricoverati_con_sintomi:"hospitalized",isolamento_domiciliare:"home_isolation",dimessi_guariti:"recovered"},I={deceduti:"1",terapia_intensiva:"2",ricoverati_con_sintomi:"3",isolamento_domiciliare:"4",dimessi_guariti:"5"},M=(C.g().stop(),{}),B=C.j(),R=C.k().projection(B),W=C.p().exponent(.5),H=C.o(C.q),V=function(e){function t(e){return Object(_.a)(this,t),Object(w.a)(this,Object(x.a)(t).call(this,e))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=Object(P.a)(O.a.mark((function e(){var t,a,r,o,s,l,c,u,d,h,m,p,f,v;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e},f=function(e){M[e].filter((function(e){return"Lombardia"===e.denominazione_regione})).forEach((function(t){var a=u[e].filter((function(e){return e.id.toString().substring(0,2)===t.code}));console.log(a.length),v(a);var n=d[e].filter((function(e){return e.source.toString().substring(0,2)===t.code})),i=C.g(a).force("center",C.c(0,0)).force("links",C.e([]).id((function(e){return e.id})).distance(0).strength(.01).iterations(8)).force("charge",C.f().strength(-.01)).force("collision",C.d(.35).strength(1)).force("x",C.h()).force("y",C.i()).on("tick",(function(){document.title=i.alpha(),r.each((function(e,t){var a=Math.hypot(e.x,e.y),n=M[m].find((function(t){return t.code===e.id.substring(0,2)})).r;if(a>n){e.y;var i=e.x/a,r=e.y/e.x,o=Math.atan(r),s=Math.cos(o)*n,l=Math.sin(o)*n;i<0&&(s*=-1,l*=-1),e.x=s,e.y=l}})).attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y}))})).alphaMin(.01).on("end",(function(){console.log(t.denominazione_regione,"simulation ended"),r.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),a.forEach((function(e){e.bunches_x=e.x,e.bunches_y=e.y})),i.force("links").links(n),i.alpha(1).restart().on("end",(function(){document.title="simulation ended",r.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),a.forEach((function(e){e.clusters_x=e.x,e.clusters_y=e.y})),console.log(t.denominazione_regione,"simulation clusters ended")}))})),r=p.append("g").attr("transform","translate("+t.x+","+t.y+")").attr("class",t.code).selectAll(".flower");r=r.data(a,(function(e){return e.id})).enter().append("circle").classed("flower",!0).attr("r",.5).attr("fill",(function(e){return H(e.id.toString().substring(2,4))})).style("opacity",.7).attr("cx",t.x).attr("cy",t.y)}))},t=C.r(this._rootNode),a=t.append("g"),r=C.s().on("zoom",(function(){a.attr("transform",C.b.transform)})),t.call(r),e.next=8,C.l("./data/world-50m.json");case 8:return o=e.sent,s=S.a(o,o.objects.countries),l=s.features.find((function(e){return"380"===e.id})),B.fitExtent([[5,5],[758,1014]],l),(n=(n=a.append("g").attr("class","countries").selectAll(".country")).data(s.features)).exit().remove(),n.enter().append("path").classed("country",!0).merge(n).attr("d",R).attr("fill","#fafafa").attr("stroke","#eef3bd").attr("stroke-width","0.5px"),e.next=18,C.a("./data/dpc-covid19-ita-regioni.csv");case 18:c=e.sent,W.range([0,70]).domain([0,C.m(c,(function(e){return Number(e.totale_casi)}))]),u={},d={},h=C.n().key((function(e){return e.data})).entries(c),m="2020-02-24T18:00:00",m="2020-03-10T18:00:00",(h=h.filter((function(e){return e.key===m}))).forEach((function(e){console.log(e),u[e.key]=[],d[e.key]=[],M[e.key]=[];var t=e.values,a=t.filter((function(e){return"04"===e.codice_regione})),n={data:e.key,stato:"ITA",codice_regione:"04",denominazione_regione:"Trentino-Alto Adige",lat:"46.49933453",long:"11.35662422",ricoverati_con_sintomi:Number(a[0].ricoverati_con_sintomi)+Number(a[1].ricoverati_con_sintomi),terapia_intensiva:Number(a[0].terapia_intensiva)+Number(a[1].terapia_intensiva),totale_ospedalizzati:Number(a[0].totale_ospedalizzati)+Number(a[1].totale_ospedalizzati),isolamento_domiciliare:Number(a[0].isolamento_domiciliare)+Number(a[1].isolamento_domiciliare),totale_positivi:Number(a[0].totale_positivi)+Number(a[1].totale_positivi),variazione_totale_positivi:Number(a[0].variazione_totale_positivi)+Number(a[1].variazione_totale_positivi),nuovi_positivi:Number(a[0].nuovi_positivi)+Number(a[1].nuovi_positivi),dimessi_guariti:Number(a[0].dimessi_guariti)+Number(a[1].dimessi_guariti),deceduti:Number(a[0].deceduti)+Number(a[1].deceduti),totale_casi:Number(a[0].totale_casi)+Number(a[1].totale_casi),tamponi:Number(a[0].tamponi)+Number(a[1].tamponi),note_it:"",note_en:""},i=t.indexOf(a[0]);t.splice(i,1);var r=t.indexOf(a[1]);t.splice(r,1),t.push(n),t.forEach((function(t){t.code=t.codice_regione,t.total=t.totale_casi,t.center_x=A.find((function(e){return e.region_name===t.denominazione_regione})).lon,t.center_y=A.find((function(e){return e.region_name===t.denominazione_regione})).lat,t.r=W(Number(t.total));var a=B([t.center_x,t.center_y]);t.x=a[0],t.y=a[1],delete t.data,delete t.codice_regione,delete t.stato,delete t.lat,delete t.long,delete t.totale_casi,delete t.totale_ospedalizzati,delete t.totale_positivi,delete t.variazione_totale_positivi,delete t.nuovi_positivi,delete t.tamponi,delete t.note_it,delete t.note_en,M[e.key].push(t),Object.keys(T).forEach((function(a){for(var n=0;n<t[a];++n){var i={id:t.code.toString()+""+I[a]+n.toString().padStart(6,"0")};if(u[e.key].push(i),0===n)for(var r=1;r<Number(I[a]);++r){var o={source:t.code.toString()+""+r+"0".toString().padStart(6,"0"),target:i.id};d[e.key].push(o)}else{var s={source:t.code.toString()+""+I[a]+"0".toString().padStart(6,"0"),target:i.id};d[e.key].push(s)}}}))}))})),i=(i=a.selectAll(".region")).data(M[m],(function(e){return e.code})).enter().append("circle").attr("class",(function(e){return e.denominazione_regione})).attr("fill","white").attr("stroke","#cccccc").classed("region",!0).attr("r",(function(e){return W(+e.total)})),C.g(M[m]).force("x",C.h((function(e){return e.x}))).force("y",C.i((function(e){return e.y}))).force("collision",C.d((function(e){return W(e.total)}))).on("tick",(function(){i.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y}))})).on("end",(function(){f(m)})).alpha(1).restart(),p=a.append("g").classed("flowers",!0);case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return v.a.createElement("svg",{ref:this._setRef.bind(this),style:{width:"768px",height:"1024px",backgroundColor:"#eef3bd"}})}}]),t}(f.Component),q=a(1),F=a(21),G=window.devicePixelRatio||1,U=[],X=0,Y=(C.j().translate([D.map.width/2,D.map.height/2]).scale(D.map.scale).center([12.368775000000001,42.9451139]),function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={viewBuffer:null},a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=this;r=window.innerWidth/G,o=window.innerHeight/G;var t=Object.keys(this.props.unique_IDS).length;console.log("amount:",t),s=new q.Application({width:r,height:o,backgroundColor:16056305,resolution:G,powerPreference:"high-performance"}),this._rootNode.appendChild(s.view);var a=new F.a({passiveWheel:!1,stopPropagation:!0,divWheel:this._rootNode,screenWidth:r,screenHeight:o,worldWidth:r,worldHeight:o,interaction:s.renderer.plugins.interaction});a.drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),s.stage.addChild(a);var n=new q.ParticleContainer(t,{vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!1});a.addChild(n);var i={};s.loader.add("sprites","./flowers-textures-ita-1.png"),s.loader.onProgress.add((function(e){console.log(e.progress+"%")})),s.loader.onComplete.add(Object(P.a)(O.a.mark((function t(){var r,o,l,c,u,d,h,m;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loader completed"),r=s.loader.resources.sprites.texture.baseTexture,t.next=4,C.l("./flowers-textures-ita-1.json");case 4:for(l in(o=t.sent).frames)c=o.frames[l].frame,u=new q.Texture(r,new q.Rectangle(c.x,c.y,c.w,c.h)),i[l.replace(".png","")]=u;for(h in d={},e.props.unique_IDS)(m=new Z(i[e.props.unique_IDS[h].category])).x=Number(e.props.unique_IDS[h].position.x),m.y=Number(e.props.unique_IDS[h].position.y),m.anchor.x=.5,m.anchor.y=.5,m.scale.x=.125,m.scale.y=.125,d[h]=m;e.state.viewBuffer=new J(d,n),e.state.viewBuffer.setDrawList(e.props.data,e.props.model),e.state.viewBuffer.drawObjects(),X=Date.now(),function e(){var t=(Date.now()-X)/1e3;X=Date.now();for(var n=0;n<U.length;++n)U[n](t);s.renderer.render(a),requestAnimationFrame(e)}();case 14:case"end":return t.stop()}}),t)})))),s.loader.load()}},{key:"componentDidUpdate",value:function(e){e.data!==this.props.data?(this.state.viewBuffer.clearObjects(),this.state.viewBuffer.setDrawList(this.props.data,this.props.model),this.state.viewBuffer.drawObjects()):e.model!==this.props.model&&(this.state.viewBuffer.model=this.props.model,this.state.viewBuffer.startAnimation(5,s))}},{key:"render",value:function(){return v.a.createElement("div",{style:{width:"100vw",height:"100vh"},ref:this._setRef.bind(this)})}}]),t}(f.Component)),J=function(){function e(t,a){Object(_.a)(this,e),this.master={},this.drawList=[],this.animationTime=0,this.timeLeft=0,this.app=null,this.container=null,this.model=null,this.master=t,this.container=a}return Object(b.a)(e,[{key:"setDrawList",value:function(e,t){this.drawList=e,this.model=t}},{key:"clearObjects",value:function(){this.container.removeChildren()}},{key:"drawObjects",value:function(){if("stripes"!==this.model)for(var e=0;e<this.drawList.length;++e)this.master[this.drawList[e].id].position.x=Number(this.drawList[e][this.model+"_x"]),this.master[this.drawList[e].id].position.y=Number(this.drawList[e][this.model+"_y"]),this.container.addChild(this.master[this.drawList[e].id]);else for(var t=0;t<this.drawList.length;++t)this.master[this.drawList[t].id].position.x=Number(this.drawList[t][this.model+"_x"])*r,this.master[this.drawList[t].id].position.y=Number(this.drawList[t][this.model+"_y"])*o,this.container.addChild(this.master[this.drawList[t].id])}},{key:"startAnimation",value:function(e,t){if(this.animationTime=e,this.timeLeft=0,this.app=t,"stripes"===this.model)for(var a=0;a<this.drawList.length;++a){var n=new q.Point;n.x=Number(this.drawList[a][this.model+"_x"])*r,n.y=Number(this.drawList[a][this.model+"_y"])*o,this.master[this.drawList[a].id].setLastPoint(),this.master[this.drawList[a].id].setNextPoint(n)}else for(var i=0;i<this.drawList.length;++i){var s=new q.Point;s.x=Number(this.drawList[i][this.model+"_x"]),s.y=Number(this.drawList[i][this.model+"_y"]),this.master[this.drawList[i].id].setLastPoint(),this.master[this.drawList[i].id].setNextPoint(s)}U.push(this.animate.bind(this))}},{key:"animate",value:function(e){if(this.timeLeft+=e,this.timeLeft>=this.animationTime)U.pop();else for(var t=D.easeInOutCubic(this.timeLeft/this.animationTime),a=0;a<this.drawList.length;++a)this.master[this.drawList[a].id].moveToNextPoint(t)}}]),e}(),Z=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).nextPoint=new q.Point,a.lastPoint=new q.Point,a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"setNextPoint",value:function(e){this.nextPoint=e}},{key:"setLastPoint",value:function(){this.lastPoint=this.position}},{key:"moveToNextPoint",value:function(e){this.position.x=(1-e)*this.lastPoint.x+e*this.nextPoint.x,this.position.y=(1-e)*this.lastPoint.y+e*this.nextPoint.y}}]),t}(q.Sprite),K=Y,$=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={data:null,play:!1,unique_IDS:{}},a.changeDate=a.changeDate.bind(Object(E.a)(a)),a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"changeDate",value:function(e){e<0?e=this.state.dates.length-1:e>this.state.dates.length-1&&(e=0);var t=this.state.dates[e];this.setState({current_date:t,current_date_index:e,data_day:this.state.data[t]})}},{key:"changeModel",value:function(e){this.setState({model:e})}},{key:"componentDidMount",value:function(){var e=Object(P.a)(O.a.mark((function e(){var t,a,n,i,r,o,s,l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([C.a("./data/list-daily-datasets.csv"),C.l("./data/regioni.geojson")]);case 2:return t=e.sent,a=t[0].map((function(e){return e.date})),n={},e.next=7,Promise.all(t[0].map((function(e){return C.a("./data/"+e.file_name)})));case 7:for(i=e.sent,r=0;r<a.length;r++){for(o=0;o<i[r].length;o++)(s=i[r][o]).x=Number(s.origin_x),s.y=Number(s.origin_y),s.id in this.state.unique_IDS||(this.state.unique_IDS[s.id]={category:s.category,position:{x:s.bunches_x,y:s.bunches_y}});n[a[r]]=i[r]}return a.length-1,0,l=n[a[0]],e.next=14,this.setState({data:n,dates:a,current_date:a[0],current_date_index:0,data_day:l,model:"bunches",mapGeometries:t[1]});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return v.a.createElement("div",{ref:this._setRef.bind(this)},this.state.data&&v.a.createElement(K,{data:this.state.data_day.reverse(),model:this.state.model,mapGeometries:this.state.mapGeometries,play:this.state.play,current_date_index:this.state.current_date_index,changeDate:this.changeDate,unique_IDS:this.state.unique_IDS}),v.a.createElement("header",{style:{position:"fixed",top:0}},v.a.createElement("p",null,v.a.createElement("input",{type:"button",name:"prev-date",value:"\u23ea",onClick:function(){return e.changeDate(e.state.current_date_index-1)}}),v.a.createElement("input",{type:"button",name:"prev-date",value:"\u25b6\ufe0f",onClick:function(){return e.setState({play:!e.state.play},e.changeDate(e.state.current_date_index+1))}}),v.a.createElement("input",{type:"button",name:"prev-date",value:"\u23e9",onClick:function(){return e.changeDate(e.state.current_date_index+1)}}),v.a.createElement("input",{type:"button",name:"bands",value:"\ud83d\uddbc",onClick:function(){return e.changeModel("stripes")}}),v.a.createElement("input",{type:"button",name:"bunch",value:"\ud83d\udc90",onClick:function(){return e.changeModel("bunches")}}),v.a.createElement("input",{type:"button",name:"clusters",value:"\ud83c\udfaf",onClick:function(){return e.changeModel("clusters")}}),this.state.current_date)))}}]),t}(f.Component),Q=new(a(90).GPU),ee=window.devicePixelRatio||1,te=function(e){function t(){return Object(_.a)(this,t),Object(w.a)(this,Object(x.a)(t).apply(this,arguments))}return Object(k.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=window.innerWidth/ee,t=window.innerHeight/ee;q.Ticker.shared.stop();var a=new q.Application({autoStart:!1,width:e,height:t,backgroundColor:16056305,resolution:ee,powerPreference:"high-performance",sharedTicker:!1});this._rootNode.appendChild(a.view);var n=new F.a({passiveWheel:!1,stopPropagation:!0,divWheel:this._rootNode,screenWidth:e,screenHeight:t,worldWidth:e,worldHeight:t,interaction:a.renderer.plugins.interaction});n.drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),a.stage.addChild(n);var i=new q.ParticleContainer(2e5,{vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!1});n.addChild(i);var r=[];a.loader.add("sprites","./flowers-textures-1.png"),a.loader.onProgress.add((function(e){console.log(e.progress+"%")})),a.loader.onComplete.add(Object(P.a)(O.a.mark((function o(){var s,l,c,u,d,h,m,p,f,v,g,y,_;return O.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log("loader completed"),s=a.loader.resources.sprites.texture.baseTexture,o.next=4,C.l("./flowers-textures-1.json");case 4:for(c in(l=o.sent).frames)u=l.frames[c].frame,d=new q.Texture(s,new q.Rectangle(u.x,u.y,u.w,u.h)),r.push(d);for(h=[],[],[],m=0;m<2e5;++m)p=new ae(r[m%5]),f=e*Math.random(),v=t*Math.random(),g=-.5+Math.random(),y=-.5+Math.random(),p.x=f,p.y=v,p.speedX=g,p.speedY=y,_=[f,v,g,y],h.push(_),p.anchor.x=.5,p.anchor.y=.5,p.scale.x=.125,p.scale.y=.125,i.addChild(p);Q.createKernel((function(e,t){var a=e[this.thread.x][2],n=e[this.thread.x][0]+a;n<0?(n=0,a*=-1):n>t[0]&&(n=t[0],a*=-1);var i=e[this.thread.x][3],r=e[this.thread.x][1]+i;return r<0?(r=0,i*=-1):r>t[1]&&(r=t[1],i*=-1),[n,r,a,i]})).setOutput([2e5]),0,function r(){0;for(var o=0;o<2e5;o++){var s=i.children[o];s.x+=s.speedX,s.x>e?(s.speedX*=-1,s.x=e):s.x<0&&(s.speedX*=-1,s.x=0),s.y+=s.speedY,s.y>t?(s.speedY*=-1,s.y=t):s.y<0&&(s.speedY*=-1,s.y=0)}a.renderer.render(n),requestAnimationFrame(r)}();case 14:case"end":return o.stop()}}),o)})))),a.loader.load()}},{key:"_setRef",value:function(e){this._rootNode=e}},{key:"render",value:function(){return v.a.createElement("div",{ref:this._setRef.bind(this)})}}]),t}(f.Component),ae=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).nextPoint=new q.Point,a.lastPoint=new q.Point,a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"setNextPoint",value:function(e){this.nextPoint=e}},{key:"setLastPoint",value:function(){this.lastPoint=this.position}},{key:"moveToNextPoint",value:function(e){this.position.x=(1-e)*this.lastPoint.x+e*this.nextPoint,this.position.y=(1-e)*this.lastPoint.y+e*this.nextPoint}}]),t}(q.Sprite),ne=te,ie=(a(158),window.devicePixelRatio||1),re=getComputedStyle(document.documentElement).getPropertyValue("font-size").replace("px",""),oe=window.innerWidth,se=window.innerHeight,le=C.j(),ce=C.k(),ue=[],de=0;console.log(re);var he=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={model:"bunches",viewBuffer:null,day:"none",day_index:-1},a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=this;document.getElementsByClassName("App")[0].classList.add("visualization-component");var t={};(p=Object.keys(this.props.data)).forEach((function(a){for(var n=0;n<e.props.data[a].length;++n){var i=e.props.data[a][n];i.id in t||(t[i.id]={})}}));var a=Object.keys(t);l=new q.Application({width:oe,height:se,transparent:!0,autoDensity:!0,resolution:ie,powerPreference:"high-performance",antialias:!1,sharedTicker:!1,autoStart:!1}),q.Ticker.shared.stop(),this._rootNode.querySelector("#visualization").appendChild(l.view),(c=new F.a({passiveWheel:!1,stopPropagation:!0,divWheel:this._rootNode,screenWidth:oe,screenHeight:se,worldWidth:oe,worldHeight:se,interaction:l.renderer.plugins.interaction})).clampZoom({minScale:.75,maxScale:5}).drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),l.stage.addChild(c),d=new q.Container,c.addChild(d);var n=this.props.topojson,i=S.a(n,n.objects.countries),r=i.features.find((function(t){return t.id===e.props.country_info.country_code}));le.fitExtent([[5,5],[758,1014]],r),i.features.filter((function(t){return t.id===e.props.country_info.country_code})).forEach((function(e){var t=new q.Graphics;ce.projection(le).context(t);var a=getComputedStyle(document.documentElement).getPropertyValue("--map-land-fill").replace("#","0x"),n=getComputedStyle(document.documentElement).getPropertyValue("--map-land-stroke").replace("#","0x");t.beginFill(a,1),n.includes("none")||t.lineStyle(1,n,.5),ce(e),t.endFill(),d.addChild(t)})),(h=new q.Container).renderable=!1,c.addChild(h),u=new q.ParticleContainer(a.length,{scale:!0,vertices:!1,position:!0,rotation:!1,uvs:!1,tint:!1}),c.addChild(u),l.loader.add("flowersTextures","./flowers-textures-1.json"),l.loader.onComplete.add((function(){m=l.loader.resources.flowersTextures.textures;for(var t={},n=0;n<a.length;++n){var i=a[n],r=e.props.country_info.categories_codes[i.substring(2,3)]+".png",o=new pe(m[r]);o.x=50,o.y=50,o.anchor.x=.5,o.anchor.y=.5;o.scaleValues=[1/m[r].orig.width*13,1/m[r].orig.height*13],o.scale.x=o.scaleValues[0],o.scale.y=o.scaleValues[1],t[i]=o}var s=new me(t,u),d=p.length-1;e.setState({day:p[d],day_index:d,viewBuffer:s}),c.on("zoomed",(function(){s.rescaleObjects(c.transform.scale._x)})),de=Date.now();!function e(){var t=(Date.now()-de)/1e3;de=Date.now();for(var a=0;a<ue.length;++a)ue[a](t);l.renderer.render(c),requestAnimationFrame(e)}()})),l.loader.load()}},{key:"componentDidUpdate",value:function(e,t){t.day_index!==this.state.day_index?(this.state.viewBuffer.drawRegionsInfo(this.props.regionsInfo[p[this.state.day_index]]),this.state.viewBuffer.clearObjects(),this.state.viewBuffer.setDrawList(this.props.data[p[this.state.day_index]],this.state.model),this.state.viewBuffer.drawObjects()):t.model!==this.state.model&&(this.state.viewBuffer.model=this.state.model,this.state.viewBuffer.startAnimation(5,l))}},{key:"changeDate",value:function(e){e<0?e=p.length-1:e>p.length-1&&(e=0);var t=p[e];this.setState({day:t,day_index:e})}},{key:"changeModel",value:function(e){this.setState({model:e})}},{key:"componentWillUnmount",value:function(){document.getElementsByClassName("App")[0].classList.remove("visualization-component")}},{key:"render",value:function(){var e=this;return v.a.createElement("div",{className:"visualization-container","data-country-name":this.props.country_info.country_name.toLowerCase(),ref:this._setRef.bind(this)},v.a.createElement("div",{id:"visualization"}),v.a.createElement("div",{className:"header"},v.a.createElement(j.b,{to:"/"},v.a.createElement("h6",{style:{textAlign:"left"}},"Home")),v.a.createElement("h4",{style:{textAlign:"center"}},"aflowerstandsfor"),v.a.createElement(j.b,{to:"/info"},v.a.createElement("h6",{style:{textAlign:"right"}},"Info"))),v.a.createElement("div",{className:"selector-date"},v.a.createElement("button",{type:"button",onClick:function(){return e.changeDate(e.state.day_index-1)}},v.a.createElement("h5",null,"<-")),v.a.createElement("div",{className:"selected-date blend-multiply"},v.a.createElement("h5",null,this.state.day)),v.a.createElement("button",{type:"button",onClick:function(){return e.changeDate(e.state.day_index+1)}},v.a.createElement("h5",null,"->"))),v.a.createElement("div",{className:"selector-layout"},v.a.createElement("button",{className:"blend-multiply ".concat("stripes"===this.state.model?"active":""),type:"button",onClick:function(){return e.changeModel("stripes")}},v.a.createElement("h5",null,"overview")),v.a.createElement("button",{className:"blend-multiply ".concat("bunches"===this.state.model?"active":""),type:"button",onClick:function(){return e.changeModel("bunches")}},v.a.createElement("h5",null,"regions")),v.a.createElement("button",{className:"blend-multiply ".concat("clusters"===this.state.model?"active":""),type:"button",onClick:function(){return e.changeModel("clusters")}},v.a.createElement("h5",null,"details"))))}}]),t}(f.Component),me=function(){function e(t,a){Object(_.a)(this,e),this.master={},this.drawList=[],this.animationTime=0,this.timeLeft=0,this.app=null,this.container=null,this.model=null,this.master=t,this.container=a}return Object(b.a)(e,[{key:"setDrawList",value:function(e,t){this.drawList=e,this.model=t}},{key:"clearObjects",value:function(){this.container.removeChildren()}},{key:"drawObjects",value:function(){if("stripes"!==this.model)for(var e=0;e<this.drawList.length;++e)this.master[this.drawList[e].id].position.x=Number(this.drawList[e][this.model+"_x"]),this.master[this.drawList[e].id].position.y=Number(this.drawList[e][this.model+"_y"]),this.container.addChild(this.master[this.drawList[e].id]);else for(var t=0;t<this.drawList.length;++t)this.master[this.drawList[t].id].position.x=Number(this.drawList[t][this.model+"_x"])*(oe-40)+20,this.master[this.drawList[t].id].position.y=Number(this.drawList[t][this.model+"_y"])*(se-40)+20,this.container.addChild(this.master[this.drawList[t].id])}},{key:"rescaleObjects",value:function(e){for(var t=0;t<this.drawList.length;++t){var a=this.master[this.drawList[t].id];a.scale.x=a.scaleValues[0]/e,a.scale.y=a.scaleValues[1]/e}}},{key:"drawRegionsInfo",value:function(e){h.removeChildren(),e.forEach((function(e){var t=new q.Graphics;t.lineStyle(1,16711680,.5),t.drawCircle(Number(e.x),Number(e.y),Number(e.r)),h.addChild(t);var a=new q.Text(e.denominazione_regione+"-"+e.total,{fontFamily:"Arial",fontSize:10,fill:16715792,align:"left"});a.x=Number(e.x),a.y=Number(e.y),h.addChild(a)}))}},{key:"startAnimation",value:function(e,t){if(this.animationTime=e,this.timeLeft=0,this.app=t,"stripes"===this.model)for(var a=0;a<this.drawList.length;++a){var n=new q.Point;n.x=Number(this.drawList[a][this.model+"_x"])*(oe-40)+20,n.y=Number(this.drawList[a][this.model+"_y"])*(se-40)+20,this.master[this.drawList[a].id].setLastPoint(),this.master[this.drawList[a].id].setNextPoint(n)}else for(var i=0;i<this.drawList.length;++i){var r=new q.Point;r.x=Number(this.drawList[i][this.model+"_x"]),r.y=Number(this.drawList[i][this.model+"_y"]),this.master[this.drawList[i].id].setLastPoint(),this.master[this.drawList[i].id].setNextPoint(r)}ue.push(this.animate.bind(this))}},{key:"animate",value:function(e){if(this.timeLeft+=e,this.timeLeft>=this.animationTime)ue.pop();else for(var t=D.easeInOutCubic(this.timeLeft/this.animationTime),a=0;a<this.drawList.length;++a)this.master[this.drawList[a].id].moveToNextPoint(t)}}]),e}(),pe=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).nextPoint=new q.Point,a.lastPoint=new q.Point,a.originalScale=null,a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"setNextPoint",value:function(e){this.nextPoint=e}},{key:"setLastPoint",value:function(){this.lastPoint=this.position}},{key:"moveToNextPoint",value:function(e){this.position.x=(1-e)*this.lastPoint.x+e*this.nextPoint.x,this.position.y=(1-e)*this.lastPoint.y+e*this.nextPoint.y}}]),t}(q.Sprite),fe=he,ve=function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={},a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=Object(P.a)(O.a.mark((function e(){var t,a,n,i,r,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([C.a("./data/italy/datasets.csv"),C.l("./data/world-50m.json")]);case 2:return t=e.sent,e.next=5,Promise.all(t[0].map((function(e){return C.a("./data/italy/"+e.file_name)})));case 5:return a=e.sent,e.next=8,Promise.all(t[0].map((function(e){return C.a("./data/italy/"+e.file_name.replace(".csv","-regions.csv"))})));case 8:n=e.sent,i={},r={},t[0].map((function(e){return e.date})).forEach((function(e,t){i[e]=a[t],r[e]=n[t]})),o=t[1],this.setState({data:i,regionsInfo:r,topojson:o});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return v.a.createElement("div",{style:{gridColumn:"1 / -1",gridRow:"1 / -1"},ref:this._setRef.bind(this)},!this.state.data&&v.a.createElement("div",null,"Loading data..."),this.state.data&&v.a.createElement(fe,{data:this.state.data,regionsInfo:this.state.regionsInfo,topojson:this.state.topojson,country_info:ge}))}}]),t}(f.Component),ge={country_name:"Italy",country_code:"380",regions_codes:{13:"Abruzzo",17:"Basilicata",18:"Calabria",15:"Campania","08":"Emilia-Romagna","06":"Friuli Venezia Giulia",12:"Lazio","07":"Liguria","03":"Lombardia",11:"Marche",14:"Molise","01":"Piemonte",16:"Puglia",20:"Sardegna",19:"Sicilia","09":"Toscana","04":"Trentino-Alto Adige",10:"Umbria","02":"Valle d'Aosta","05":"Veneto"},categories_codes:{1:"deceased",2:"intensive_cares",3:"hospitalized",4:"home_isolation",5:"recovered"}},ye=(a(163),function(e){function t(e){var a;return Object(_.a)(this,t),(a=Object(w.a)(this,Object(x.a)(t).call(this,e))).state={language:a.props.language},a.changeLanguage=a.changeLanguage.bind(Object(E.a)(a)),a}return Object(k.a)(t,e),Object(b.a)(t,[{key:"changeLanguage",value:function(e){this.setState({language:e})}},{key:"render",value:function(){var e=this;return v.a.createElement(j.a,{basename:"/"},v.a.createElement(L.a,{exact:!0,path:"/"},v.a.createElement("div",{className:"header"},v.a.createElement(j.b,{to:"/"},v.a.createElement("h6",{style:{textAlign:"left"}},"Home")),v.a.createElement("h4",{style:{textAlign:"center"}},"aflowerstandsfor"),v.a.createElement(j.b,{to:"/info"},v.a.createElement("h6",{style:{textAlign:"right"}},"Info"))),v.a.createElement("div",{className:"selector languages"},v.a.createElement("button",{type:"button",onClick:function(){e.changeLanguage("hi-HI")}},v.a.createElement("h5",null,"hindi")),v.a.createElement("button",{type:"button",onClick:function(){e.changeLanguage("it-IT")}},v.a.createElement("h5",null,"italian")),v.a.createElement("button",{type:"button",className:"active",onClick:function(){e.changeLanguage("en-US")}},v.a.createElement("h5",null,"english"))),v.a.createElement("div",{className:"title-box"},v.a.createElement("h1",null,"A \ud83c\udf38 stands for a CoViD-19 case in:")),v.a.createElement(j.b,{className:"country",to:"/india"},v.a.createElement("h3",null,"India")),v.a.createElement(j.b,{className:"country",to:"/italy"},v.a.createElement("h3",null,"Italy")),v.a.createElement(j.b,{className:"country",to:"/canada"},v.a.createElement("h3",null,"Canada"))),v.a.createElement(L.a,{path:"/menumenu"},v.a.createElement("nav",null,v.a.createElement("ul",null,v.a.createElement("li",null,v.a.createElement(j.b,{to:"/performances"},"Testing PIXIjs performances")),v.a.createElement("li",null,v.a.createElement(j.b,{to:"/viz"},"Visualization")),v.a.createElement("li",null,v.a.createElement(j.b,{to:"/italy"},"Italy")),v.a.createElement("li",null,v.a.createElement(j.b,{to:"/styles"},"Styles"))))),v.a.createElement(L.a,{path:"/svg"},v.a.createElement(V,null)),v.a.createElement(L.a,{path:"/pixi"},v.a.createElement(K,null)),v.a.createElement(L.a,{path:"/viz"},v.a.createElement($,null)),v.a.createElement(L.a,{path:"/performances"},v.a.createElement(ne,null)),v.a.createElement(L.a,{path:"/italy"},v.a.createElement(ve,null)),v.a.createElement(L.a,{path:"/styles"},v.a.createElement("h1",null,"Header 1"),v.a.createElement("h2",null,"Header 2"),v.a.createElement("h3",null,"Header 3"),v.a.createElement("h4",null,"Header 4"),v.a.createElement("h5",null,"Header 5"),v.a.createElement("h6",null,"Header 6")))}}]),t}(f.Component));var _e=function(){return v.a.createElement("div",{className:"App"},v.a.createElement(ye,{language:navigator.language}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));y.a.render(v.a.createElement(_e,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[124,1,2]]]);
//# sourceMappingURL=main.810c6701.chunk.js.map