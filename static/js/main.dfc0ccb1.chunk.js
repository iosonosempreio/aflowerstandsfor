(this["webpackJsonpcovi-z"]=this["webpackJsonpcovi-z"]||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var i,o,a,r,c=n(0),l=n.n(c),s=n(54),d=n.n(s),u=(n(86),n(25)),h=n(14),m=(n(87),n(3)),f=n(4),p=n(6),g=n(2),v=n(7),w=n(9),y=n(55),_=n.n(y),x={emoji:{size:10},clampZoomOptions:{minScale:.5,maxScale:15},emoji_dictionary:{ricoverati_con_sintomi:"\ud83c\udf3a",terapia_intensiva:"\ud83d\udc90",isolamento_domiciliare:"\ud83c\udf40",dimessi_guariti:"\ud83c\udf3c",deceduti:"\ud83c\udf38"}},b=x,j=["ricoverati_con_sintomi","terapia_intensiva","isolamento_domiciliare","dimessi_guariti","deceduti"],E={ricoverati_con_sintomi:"\ud83c\udf3a",terapia_intensiva:"\ud83d\udc90",isolamento_domiciliare:"\ud83c\udf40",dimessi_guariti:"\ud83c\udf3c",deceduti:"\ud83c\udf38"},k=w.d().stop(),O=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).state={data:[]},n}return Object(v.a)(t,e),Object(f.a)(t,[{key:"_setRef",value:function(e){this._rootNode=e}},{key:"componentDidMount",value:function(){var e=this;w.a("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-regioni/dpc-covid19-ita-regioni.csv").then((function(t){var n=w.i().key((function(e){return e.data})).entries(t),o=n[n.length-1].values;console.log(o);var a=[];i=w.g().fitSize([window.innerWidth-200,window.innerHeight-200],e._rootNode).translate([window.innerWidth/2,window.innerHeight/2]).scale(3e3).center([12.368775000000001,42.9451139]),o.forEach((function(e){var t=i([e.long,e.lat]);e.x=t[0],e.y=t[1]}));for(var r=function(e){j.forEach((function(t){for(var n=0;n<o[e][t];++n){var i={category:t,denominazione_regione:o[e].denominazione_regione,date:o[e].data,x:o.find((function(t){return t.denominazione_regione===o[e].denominazione_regione})).x,y:o.find((function(t){return t.denominazione_regione===o[e].denominazione_regione})).y};a.push(i)}}))},c=0;c<o.length;++c)r(c);e.setState({raw_data:o,data:a},(function(){var t=w.j(e._rootNode),n=t.append("g");t.call(w.k().extent([[0,0],[window.innerWidth,window.innerHeight]]).scaleExtent([b.clampZoomOptions.minScale,b.clampZoomOptions.maxScale]).on("zoom",(function(){n.attr("transform",w.b.transform)})));var i=n.selectAll("text").data(e.state.data).enter().append("text").attr("font-size",b.emoji.size+"px").text((function(e){return E[e.category]})),o=window.prompt("Set the alpha decay of force simulation",.005);k.nodes(a).on("tick",(function(){document.title=k.alpha().toFixed(4)})).force("x",w.e((function(e){return e.x}))).force("y",w.f((function(e){return e.y}))).force("collision",w.c(.35)).alphaDecay(o).alpha(1).on("end",(function(){if(i.attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})),console.log("ended",a),window.confirm("\ud83c\udf3a\ud83c\udf3f\u2618\ufe0f\ud83c\udf3c\ud83c\udf38 download spatialized data?")){for(var e=0;e<a.length;++e)delete a[e].index,delete a[e].vx,delete a[e].vy;var t=new Blob([JSON.stringify(a)],{type:"application/json;charset=utf-8"});_.a.saveAs(t,"covi-z.json")}})).restart()}))}))}},{key:"render",value:function(){return console.log(this.state.data),l.a.createElement("svg",{ref:this._setRef.bind(this),style:{width:"100%",height:"100%"}})}}]),t}(c.Component),z=n(16),W=n(1),S=n(57),C=n(58),D=n.n(C),H=window.innerWidth,N=window.innerHeight,R=window.devicePixelRatio||1,A=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).loadData=n.loadData.bind(Object(z.a)(n)),n.state={textures:{}},n}return Object(v.a)(t,e),Object(f.a)(t,[{key:"loadData",value:function(){return w.h("./data/covi-z.json")}},{key:"componentDidMount",value:function(){for(var e=this,t=document.querySelectorAll("#textures-generation>span"),n={},i=function(i){D()(t[i],{backgroundColor:null}).then((function(c){n[t[i].id]=c.toDataURL("image/png"),Object.keys(n).length===Object.keys(b.emoji_dictionary).length&&e.setState({textures:n},(function(){console.log(e.state),o=new W.Application({width:H,height:N,backgroundColor:16448250,resolution:R,autoResize:!0}),e._rootNode.appendChild(o.view),(a=new S.a({center:new W.Point(-window.innerWidth/2,-window.innerHeight/2),passiveWheel:!1,stopPropagation:!0,divWheel:e._rootNode,screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:window.innerWidth,worldHeight:window.innerHeight,interaction:o.renderer.plugins.interaction})).clampZoom(b.clampZoomOptions).drag({pressDrag:!0,clampWheel:!0}).pinch().wheel(),o.stage.addChild(a),r=new W.Container,a.addChild(r),e.loadData().then((function(t){for(var n=0;n<t.length;++n){var i=W.Sprite.from(e.state.textures[t[n].category]);i.anchor.set(.5),i.x=t[n].x,i.y=t[n].y,i.scale.x=.05,i.scale.y=.05,r.addChild(i)}}))}))}))},c=0;c<t.length;++c)i(c)}},{key:"_setRef",value:function(e){this._rootNode=e}},{key:"render",value:function(){return l.a.createElement("div",{style:{width:"100%",height:"100%"},ref:this._setRef.bind(this)},0===Object.keys(this.state.textures).length&&l.a.createElement("div",{id:"textures-generation",style:{fontSize:b.emoji.size+"px",position:"absolute",top:"-100px"}},Object.keys(b.emoji_dictionary).map((function(e){return l.a.createElement("span",{id:e,key:"emoji-".concat(e)},b.emoji_dictionary[e])}))))}}]),t}(c.Component);var Z=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(u.a,{basename:"/"},l.a.createElement(h.a,{path:"/svg"},l.a.createElement(O,null)),l.a.createElement(h.a,{path:"/pixi"},l.a.createElement(A,null)),l.a.createElement(h.a,{exact:!0,path:"/"},l.a.createElement("nav",null,l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement(u.b,{to:"/svg"},"SVG Version")),l.a.createElement("li",null,l.a.createElement(u.b,{to:"/pixi"},"PIXIjs version")))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.render(l.a.createElement(Z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},81:function(e,t,n){e.exports=n(102)},86:function(e,t,n){},87:function(e,t,n){}},[[81,1,2]]]);
//# sourceMappingURL=main.dfc0ccb1.chunk.js.map